/changePassword:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: changePassword
    parameters:
      - name: body
        in: body
        schema:
          properties:
            email:
              type: string
            oldPassword:
              type: string
            newPassword:
              type: string
    responses:
      200:
        description: password changed
      400:
        description: password not changed
      401:
        description: unauthorized
      422:
        description: password validation failure
        schema:
          $ref: '#/definitions/errorMessage'
      500:
        description: internal server error

/invite:
  post:
    tags:
      - account
    operationId: invite
    parameters:
      - name: body
        in: body
        schema:
          properties:
            email:
              type: string
            inviteToken:
              type: string
    responses:
      201:
        description: invitation created
      400:
        description: invitation not created (already exists)
        schema:
          $ref: '#/definitions/errorMessage'
      401:
        description: unauthorized
      500:
        description: internal server error

/login:
  post:
    tags:
      - account
    operationId: login
    parameters:
      - name: body
        in: body
        schema:
          properties:
            email:
              type: string
            password:
              type: string
    responses:
      200:
        description: login successful
        schema:
          type: string
      202:
        description: mfa required
        schema:
          properties:
            pendingToken:
              type: string
      401:
        description: invalid login
      403:
        description: mfa enrollment required (when mfaRequired is enabled and user has no MFA)

/regenerateAccountToken:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: regenerateAccountToken
    parameters:
      - name: body
        in: body
        schema:
          properties:
            emailAddress:
              type: string
    responses:
      200:
        description: regenerate account token
        schema:
          properties:
            accountToken:
              type: string
      404:
        description: account not found
      500:
        description: internal server error

/register:
  post:
    tags:
      - account
    operationId: register
    parameters:
      - name: body
        in: body
        schema:
          properties:
            registerToken:
              type: string
            password:
              type: string
    responses:
      200:
        description: account created
        schema:
          properties:
            accountToken:
              type: string
      404:
        description: request not found
      422:
        description: password validation failure
        schema:
          $ref: '#/definitions/errorMessage'
      500:
        description: internal server error

/resetPassword:
  post:
    tags:
      - account
    operationId: resetPassword
    parameters:
      - name: body
        in: body
        schema:
          properties:
            resetToken:
              type: string
            password:
              type: string
    responses:
      200:
        description: password reset
      404:
        description: request not found
      422:
        description: password validation failure
        schema:
          $ref: '#/definitions/errorMessage'
      500:
        description: internal server error

/resetPasswordRequest:
  post:
    tags:
      - account
    operationId: resetPasswordRequest
    parameters:
      - name: body
        in: body
        schema:
          properties:
            emailAddress:
              type: string
    responses:
      201:
        description: reset password request created
      400:
        description: reset password request not created
      500:
        description: internal server error

/verify:
  post:
    tags:
      - account
    operationId: verify
    parameters:
      - name: body
        in: body
        schema:
          properties:
            registerToken:
              type: string
    responses:
      200:
        description: registration token ready
        schema:
          properties:
            email:
              type: string
      404:
        description: registration token not found
      500:
        description: internal server error

/mfa/setup:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: mfaSetup
    responses:
      200:
        description: mfa setup initiated
        schema:
          properties:
            secret:
              type: string
            qrCode:
              type: string
            provisioningUri:
              type: string
      400:
        description: mfa already enabled
      401:
        description: unauthorized
      500:
        description: internal server error

/mfa/verify:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: mfaVerify
    parameters:
      - name: body
        in: body
        schema:
          properties:
            code:
              type: string
    responses:
      200:
        description: mfa enabled
        schema:
          properties:
            recoveryCodes:
              type: array
              items:
                type: string
      400:
        description: invalid code or no pending setup
      401:
        description: unauthorized
      500:
        description: internal server error

/mfa/status:
  get:
    tags:
      - account
    security:
      - key: []
    operationId: mfaStatus
    responses:
      200:
        description: mfa status
        schema:
          properties:
            enabled:
              type: boolean
            recoveryCodesRemaining:
              type: integer
      401:
        description: unauthorized
      500:
        description: internal server error

/mfa/disable:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: mfaDisable
    parameters:
      - name: body
        in: body
        schema:
          properties:
            password:
              type: string
            code:
              type: string
    responses:
      200:
        description: mfa disabled
      400:
        description: invalid password or code
      401:
        description: unauthorized
      500:
        description: internal server error

/mfa/recoveryCodes:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: mfaRecoveryCodes
    parameters:
      - name: body
        in: body
        schema:
          properties:
            code:
              type: string
    responses:
      200:
        description: new recovery codes generated
        schema:
          properties:
            recoveryCodes:
              type: array
              items:
                type: string
      400:
        description: invalid code or mfa not enabled
      401:
        description: unauthorized
      500:
        description: internal server error

/mfa/authenticate:
  post:
    tags:
      - account
    operationId: mfaAuthenticate
    parameters:
      - name: body
        in: body
        schema:
          properties:
            pendingToken:
              type: string
            code:
              type: string
    responses:
      200:
        description: authentication successful
        schema:
          type: string
      401:
        description: invalid pending token or code
      500:
        description: internal server error

/mfa/challenge:
  post:
    tags:
      - account
    security:
      - key: []
    operationId: mfaChallenge
    parameters:
      - name: body
        in: body
        schema:
          properties:
            code:
              type: string
    responses:
      200:
        description: challenge token issued
        schema:
          properties:
            challengeToken:
              type: string
            expiresAt:
              type: string
              format: date-time
      400:
        description: invalid code or mfa not enabled
      401:
        description: unauthorized
      500:
        description: internal server error